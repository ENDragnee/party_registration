{% extends 'party_register_app/base.html' %}

{% block title %}You're In!{% endblock %}

{% block content %}
<div class="card drac-card text-center w-100">
    <div class="card-body p-4 p-md-5">
        <!-- Success Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-patch-check-fill mb-3" viewBox="0 0 16 16" style="color: var(--drac-green);">
            <path d="M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01-.622-.636zm.287 5.984-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708.708z"/>
        </svg>

        <h1 style="color: var(--drac-green);">You're on the list, {{ guest.name }}!</h1>
        <p class="lead" style="color: var(--drac-foreground);">Your QR code is ready. You can screenshot it or download the official ticket.</p>
        
        <!-- The on-screen QR code. White background is crucial for scannability. -->
        <div class="my-4 p-3 d-inline-block rounded" style="background-color: white;">
            <img src="data:image/png;base64,{{ qr_code_base64 }}" alt="Your QR Code Ticket" class="img-fluid" style="max-width: 250px;">
        </div>
        
        <div class="d-grid gap-2 col-lg-8 mx-auto mt-4">
            <!-- THE NEW DOWNLOAD BUTTON -->
            <a href="{% url 'download_ticket' guest.unique_id %}" class="btn btn-primary-drac btn-lg">
                Download Ticket (PDF)
            </a>
            
            <a href="{% url 'landing_page' %}" class="btn btn-outline-light">Back to Home</a>
        </div>
    </div>
</div>
{% endblock %}
